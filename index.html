<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>元旦晚会 - KN.WenTianPlay.top</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-red: #C62828;
            --secondary-red: #E53935;
            --dark-red: #8B0000;
            --light-red: #FF5252;
            --dark-bg: #1A0A0A;
            --light-bg: #2A0F0F;
            --text-light: #FFFFFF;
            --text-gold: #FFD700;
            --text-gray: rgba(255, 255, 255, 0.7);
            --card-bg: rgba(42, 15, 15, 0.85);
            --card-border: rgba(255, 82, 82, 0.2);
            --shadow-light: rgba(255, 82, 82, 0.15);
            --shadow-dark: rgba(139, 0, 0, 0.3);
        }

        #bg {
            -moz-animation: bg 60s linear infinite;
            -webkit-animation: bg 60s linear infinite;
            -ms-animation: bg 60s linear infinite;
            animation: bg 60s linear infinite;
            -moz-backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            -ms-backface-visibility: hidden;
            backface-visibility: hidden;
            -moz-transform: translate3d(0, 0, 0);
            -webkit-transform: translate3d(0, 0, 0);
            -ms-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            background: #ffffff url("") center left;
            background-repeat: repeat-x;
            height: 100%;
            left: 0;
            opacity: 0.9;
            position: fixed;
            top: 0;
        }

        @-moz-keyframes bg {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-8000px, 0, 0); }
        }

        @-webkit-keyframes bg {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-8000px, 0, 0); }
        }

        @-ms-keyframes bg {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-8000px, 0, 0); }
        }

        @keyframes bg {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-8000px, 0, 0); }
        }

        #bg {
            background-size: auto 65%;
            width: 6750px;
        }

        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #2c0f1a 100%);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            position: relative;
            touch-action: pan-y;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 82, 82, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: -2;
        }

        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: clamp(10px, 3vw, 30px);
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding: clamp(30px, 8vh, 80px) 0 clamp(20px, 5vh, 40px);
            position: relative;
            overflow: hidden;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: min(600px, 80%);
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-red), transparent);
        }

        h1 {
            font-size: clamp(2rem, 8vw, 4rem);
            margin-bottom: clamp(10px, 3vh, 20px);
            background: linear-gradient(45deg, var(--light-red), var(--text-gold), var(--light-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 5px 25px rgba(255, 82, 82, 0.3);
            animation: glow 3s infinite alternate;
            font-weight: 800;
            letter-spacing: 1px;
            line-height: 1.2;
        }

        .motto {
            font-size: clamp(1.1rem, 4vw, 1.8rem);
            color: var(--text-gold);
            margin-bottom: clamp(20px, 5vh, 40px);
            font-weight: 300;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 clamp(10px, 3vw, 30px);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            line-height: 1.5;
        }

        .countdown {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: clamp(20px, 6vh, 50px) 0;
            gap: clamp(8px, 2vw, 20px);
            flex-wrap: wrap;
            padding: clamp(15px, 4vw, 30px);
            background: rgba(26, 10, 10, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 82, 82, 0.2);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
        }

        .countdown-number {
            display: flex;
            justify-content: center;
            align-items: center;
            width: clamp(70px, 15vw, 100px);
            height: clamp(70px, 15vw, 100px);
            background: linear-gradient(135deg, rgba(198, 40, 40, 0.2), rgba(139, 0, 0, 0.1));
            border: 2px solid var(--primary-red);
            border-radius: 15px;
            font-size: clamp(1.8rem, 6vw, 2.8rem);
            font-weight: 700;
            color: var(--text-light);
            box-shadow: 
                inset 0 0 20px rgba(255, 82, 82, 0.1),
                0 5px 15px rgba(139, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .countdown-number::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                transparent 30%,
                rgba(255, 82, 82, 0.1) 50%,
                transparent 70%
            );
            transform: rotate(45deg);
            animation: shine 3s infinite linear;
        }

        .countdown-label {
            margin-top: clamp(8px, 2vh, 12px);
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--text-gold);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #program-section {
            margin-top: clamp(30px, 8vh, 60px);
            padding: 0 clamp(10px, 3vw, 20px);
        }

        #program-section h2 {
            text-align: center;
            margin-bottom: clamp(20px, 5vh, 40px);
            color: var(--text-gold);
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
            padding-bottom: 15px;
        }

        #program-section h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-red), transparent);
        }

        .program-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: clamp(15px, 4vw, 30px);
            margin-top: clamp(20px, 5vh, 40px);
        }

        .program-card {
            background: var(--card-bg);
            border-radius: clamp(12px, 3vw, 20px);
            overflow: hidden;
            border: 1px solid var(--card-border);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(5px);
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .program-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, 
                rgba(255, 82, 82, 0.1) 0%, 
                rgba(255, 215, 0, 0.05) 50%, 
                transparent 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
        }

        .program-card:hover::before {
            opacity: 1;
        }

        .program-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                0 20px 40px var(--shadow-dark),
                0 0 30px rgba(255, 82, 82, 0.2);
            border-color: rgba(255, 82, 82, 0.4);
        }

        .program-img {
            height: clamp(180px, 35vw, 250px);
            overflow: hidden;
            position: relative;
        }

        .program-img::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(to top, rgba(26, 10, 10, 0.9), transparent);
            z-index: 1;
        }

        .program-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .program-card:hover .program-img img {
            transform: scale(1.08);
        }

        .program-content {
            padding: clamp(15px, 4vw, 25px);
            position: relative;
            z-index: 2;
        }

        .program-content h3 {
            color: var(--text-light);
            margin-bottom: clamp(8px, 2vh, 12px);
            font-size: clamp(1.1rem, 3.5vw, 1.4rem);
            font-weight: 600;
            line-height: 1.3;
            background: linear-gradient(45deg, var(--light-red), var(--text-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .program-content p {
            color: var(--text-gray);
            margin-bottom: clamp(12px, 3vh, 18px);
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            line-height: 1.6;
        }

        .time {
            display: inline-block;
            background: linear-gradient(135deg, rgba(255, 82, 82, 0.15), rgba(139, 0, 0, 0.1));
            color: var(--light-red);
            padding: clamp(6px, 1.5vw, 8px) clamp(12px, 3vw, 18px);
            border-radius: 50px;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            border: 1px solid rgba(255, 82, 82, 0.3);
            backdrop-filter: blur(5px);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .program-card:hover .time {
            background: linear-gradient(135deg, rgba(255, 82, 82, 0.25), rgba(139, 0, 0, 0.2));
            transform: translateY(-2px);
        }

        .loading {
            text-align: center;
            padding: clamp(40px, 10vh, 60px) 0;
            color: var(--light-red);
            font-size: clamp(1rem, 3vw, 1.2rem);
            grid-column: 1 / -1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .loading i {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: var(--text-gold);
        }

        footer {
            background: linear-gradient(to top, rgba(26, 10, 10, 0.95), transparent);
            padding: clamp(30px, 8vh, 50px) 0 clamp(15px, 4vh, 20px);
            margin-top: clamp(40px, 10vh, 80px);
            border-top: 1px solid rgba(255, 82, 82, 0.2);
            position: relative;
            overflow: hidden;
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 90%, rgba(255, 82, 82, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 90% 10%, rgba(255, 215, 0, 0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .copyright {
            text-align: center;
            padding-top: clamp(15px, 4vh, 20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-gray);
            font-size: clamp(0.8rem, 2.5vw, 0.95rem);
            position: relative;
            z-index: 1;
        }

        .copyright a {
            color: var(--light-red);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            padding-bottom: 2px;
        }

        .copyright a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 1px;
            background: var(--light-red);
            transition: width 0.3s ease;
        }

        .copyright a:hover {
            color: var(--text-gold);
        }

        .copyright a:hover::after {
            width: 100%;
        }

        .back-to-top {
            position: fixed;
            bottom: clamp(20px, 5vw, 30px);
            right: clamp(20px, 5vw, 30px);
            width: clamp(45px, 8vw, 55px);
            height: clamp(45px, 8vw, 55px);
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: clamp(1rem, 3vw, 1.2rem);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            box-shadow: 
                0 5px 20px rgba(198, 40, 40, 0.4),
                inset 0 2px 4px rgba(255, 255, 255, 0.1);
            border: none;
            backdrop-filter: blur(5px);
        }

        .back-to-top:hover {
            background: linear-gradient(135deg, var(--light-red), var(--primary-red));
            transform: translateY(-5px) scale(1.1);
            box-shadow: 
                0 10px 30px rgba(255, 82, 82, 0.5),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
        }

        .back-to-top:active {
            transform: translateY(-2px) scale(1.05);
        }

        .mobile-only {
            display: none;
        }

        @keyframes glow {
            0% { text-shadow: 0 0 10px rgba(255, 82, 82, 0.4), 0 0 20px rgba(255, 82, 82, 0.2); }
            100% { text-shadow: 0 0 20px rgba(255, 82, 82, 0.8), 0 0 30px rgba(255, 82, 82, 0.6), 0 0 40px rgba(255, 215, 0, 0.3); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        @media (hover: none) and (pointer: coarse) {
            .program-card:active {
                transform: translateY(-4px) scale(1.01);
                box-shadow: 0 15px 30px var(--shadow-dark);
            }

            .back-to-top:active {
                transform: scale(0.95);
            }

            .program-img img {
                transform-origin: center center;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .countdown {
                gap: 10px;
                padding: 20px 15px;
                border-radius: 15px;
            }

            .countdown-item {
                min-width: 70px;
            }

            .program-grid {
                gap: 20px;
            }

            .program-card {
                border-radius: 15px;
            }

            .mobile-only {
                display: block;
            }

            .program-grid {
                grid-template-columns: 1fr;
                scroll-snap-type: x mandatory;
                overflow-x: auto;
                display: flex;
                padding: 10px 0;
                scrollbar-width: none;
            }

            .program-grid::-webkit-scrollbar {
                display: none;
            }

            .program-card {
                flex: 0 0 calc(100% - 30px);
                margin-right: 20px;
                scroll-snap-align: start;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 2.2rem;
            }

            .motto {
                font-size: 1.2rem;
            }

            .countdown {
                gap: 8px;
                padding: 15px 10px;
            }

            .countdown-item {
                min-width: 60px;
            }

            .countdown-number {
                width: 60px;
                height: 60px;
                font-size: 1.6rem;
            }

            .countdown-label {
                font-size: 0.8rem;
            }

            .program-grid {
                gap: 15px;
            }

            .program-card {
                flex: 0 0 calc(100% - 20px);
                margin-right: 15px;
            }

            .back-to-top {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
            }
        }

        @media (min-width: 769px) {
            .program-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .program-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #0A0505 0%, #1c0a0a 100%);
            }

            .program-card {
                background: rgba(20, 8, 8, 0.9);
            }
        }

        @media print {
            .back-to-top,
            #particles-js,
            .fireworks-container {
                display: none !important;
            }

            body {
                background: white !important;
                color: black !important;
            }

            .program-card {
                break-inside: avoid;
                border: 1px solid #ddd;
            }
        }

        .will-change {
            will-change: transform, opacity;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(26, 10, 10, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--light-red), var(--primary-red));
        }
    </style>
</head>
<body>
    <div id="bg"></div>
    <div id="particles-js"></div>
    <div class="fireworks-container" id="fireworks"></div>

    <div class="container">
        <header>
            <h1 id="year-title">元旦晚会</h1>
            <p class="motto" id="motto"></p>
            <div class="countdown">
                <div class="countdown-item">
                    <div class="countdown-number" id="days">00</div>
                    <div class="countdown-label">天</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="hours">00</div>
                    <div class="countdown-label">时</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="minutes">00</div>
                    <div class="countdown-label">分</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-number" id="seconds">00</div>
                    <div class="countdown-label">秒</div>
                </div>
            </div>
        </header>

        <div id="program-section">
            <h2>晚会节目单</h2>
            <div id="program-grid" class="program-grid">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> 
                    <span>正在加载节目数据...</span>
                </div>
            </div>
        </div>

        <footer>
            <div class="copyright">
                <p>本站图片调用的是"图床API",无法审查内容</p>
                <p>&copy; 2024 元旦晚会 | 版权所有 <a href="https://www.WenTianPlay.com" target="_blank">文天玩WenTianPlay</a></p>
            </div>
        </footer>
    </div>

    <button class="back-to-top" id="backToTop" aria-label="返回顶部">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

            if (isIOS) {
                document.body.classList.add('ios-device');
            }

            particlesJS('particles-js', {
                particles: {
                    number: { 
                        value: isMobile ? 40 : 80, 
                        density: { 
                            enable: true, 
                            value_area: isMobile ? 600 : 800 
                        } 
                    },
                    color: { value: "#FF5252" },
                    shape: { type: "circle" },
                    opacity: { 
                        value: isMobile ? 0.4 : 0.5, 
                        random: true 
                    },
                    size: { 
                        value: isMobile ? 2 : 3, 
                        random: true 
                    },
                    line_linked: {
                        enable: !isMobile,
                        distance: 150,
                        color: "#FF5252",
                        opacity: 0.4,
                        width: 1
                    },
                    move: {
                        enable: true,
                        speed: isMobile ? 1.5 : 2,
                        direction: "none",
                        random: true,
                        straight: false,
                        out_mode: "out",
                        bounce: false
                    }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: {
                        onhover: { 
                            enable: !isMobile,
                            mode: "repulse" 
                        },
                        onclick: { 
                            enable: true, 
                            mode: "push" 
                        },
                        resize: true
                    }
                }
            });

            loadEventData();

            updateCountdown();
            setInterval(updateCountdown, 1000);

            const backToTop = document.getElementById('backToTop');
            let scrollTimeout;

            window.addEventListener('scroll', function() {
                if (scrollTimeout) {
                    clearTimeout(scrollTimeout);
                }

                scrollTimeout = setTimeout(() => {
                    const showButton = window.pageYOffset > 300;
                    if (backToTop.style.display === 'none' && showButton) {
                        backToTop.style.display = 'flex';
                        setTimeout(() => backToTop.style.opacity = '1', 10);
                    } else if (!showButton) {
                        backToTop.style.opacity = '0';
                        setTimeout(() => backToTop.style.display = 'none', 300);
                    }
                }, 100);
            });

            backToTop.addEventListener('click', function() {
                window.scrollTo({ 
                    top: 0, 
                    behavior: 'smooth' 
                });
            });

            if (isMobile) {
                document.addEventListener('touchstart', function() {}, { passive: true });
                document.addEventListener('touchmove', function() {}, { passive: true });
            }

            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.documentElement.style.setProperty('--animation-speed', '0.01ms');
            }

            if (!isMobile) {
                initFireworks();
            }

            animateElements();
        });

        function animateElements() {
            const elements = document.querySelectorAll('.countdown-item, .program-card');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, 100 + index * 50);
            });
        }

        function loadEventData() {
            const programGrid = document.getElementById('program-grid');
            programGrid.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> 
                    <span>正在加载节目数据...</span>
                </div>
            `;

            const timeoutPromise = new Promise((_, reject) => {
                setTimeout(() => reject(new Error('请求超时')), 10000);
            });

            const dataPromise = fetch('index.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('网络响应不正常');
                    }
                    return response.json();
                })
                .then(config => {
                    return fetch(config.dataUrl);
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('无法加载节目数据');
                    }
                    return response.json();
                });

            Promise.race([dataPromise, timeoutPromise])
                .then(data => {
                    document.getElementById('year-title').textContent = `${data.year}元旦晚会`;
                    document.getElementById('motto').textContent = data.motto;

                    if (data.backgroundImage) {
                        const bgElement = document.getElementById('bg');
                        bgElement.style.background = `#ffffff url("${data.backgroundImage}") center left`;
                        bgElement.style.backgroundRepeat = 'repeat-x';
                    }

                    programGrid.innerHTML = '';

                    data.programs.forEach((program, index) => {
                        const programCard = document.createElement('div');
                        programCard.className = 'program-card will-change';
                        programCard.style.animationDelay = `${index * 0.1}s`;

                        const imgUrl = program.image || `https://picsum.photos/600/400?random=${index}`;
                        const fallbackImg = `https://picsum.photos/600/400?random=${index + 1000}`;

                        programCard.innerHTML = `
                            <div class="program-img">
                                <img 
                                    src="${imgUrl}" 
                                    alt="${program.title}" 
                                    loading="lazy"
                                    onerror="this.onerror=null; this.src='${fallbackImg}'"
                                >
                            </div>
                            <div class="program-content">
                                <h3>${program.title}</h3>
                                <p>${program.description || '暂无描述'}</p>
                                <span class="time">${program.time}</span>
                            </div>
                        `;

                        programGrid.appendChild(programCard);
                    });

                    setTimeout(animateElements, 100);
                })
                .catch(error => {
                    console.error('加载数据失败:', error);

                    programGrid.innerHTML = `
                        <div class="loading" id="loading-error">
                            <i class="fas fa-exclamation-triangle"></i> 
                            <p>加载失败: ${error.message}</p>
                            <p style="margin-top: 15px; font-size: clamp(0.9rem, 2.5vw, 1rem);">
                                页面将在 <span id="countdown" style="font-weight: bold; color: var(--text-gold);">10</span> 秒后自动刷新...
                            </p>
                            <button onclick="location.reload()" style="
                                margin-top: 20px;
                                padding: clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px);
                                background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
                                color: white;
                                border: none;
                                border-radius: 25px;
                                cursor: pointer;
                                font-size: clamp(0.9rem, 2.5vw, 1rem);
                                transition: all 0.3s ease;
                                font-weight: 500;
                                box-shadow: 0 4px 15px rgba(198, 40, 40, 0.3);
                            " onmouseover="this.style.background='linear-gradient(135deg, var(--light-red), var(--primary-red))'" 
                              onmouseout="this.style.background='linear-gradient(135deg, var(--primary-red), var(--dark-red))'">
                                <i class="fas fa-redo-alt"></i> 立即刷新
                            </button>
                        </div>
                    `;

                    startAutoRefresh();
                });
        }

        function updateCountdown() {
            try {
                const now = new Date();
                const currentYear = now.getFullYear();
                let newYear = new Date(currentYear + 1, 0, 1);

                if (now.getMonth() === 0 && now.getDate() === 1) {
                    newYear = new Date(currentYear, 0, 1);
                    const diff = newYear - now;
                    if (diff <= 0) {
                        newYear = new Date(currentYear + 1, 0, 1);
                    }
                }

                const diff = newYear - now;

                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                animateNumberChange('days', days);
                animateNumberChange('hours', hours);
                animateNumberChange('minutes', minutes);
                animateNumberChange('seconds', seconds);

            } catch (error) {
                console.error('倒计时更新失败:', error);
            }
        }

        function animateNumberChange(elementId, newValue) {
            const element = document.getElementById(elementId);
            if (!element) return;

            const oldValue = parseInt(element.textContent) || 0;

            if (oldValue !== newValue) {
                element.style.transform = 'scale(1.1)';
                element.style.color = 'var(--text-gold)';

                setTimeout(() => {
                    element.textContent = newValue.toString().padStart(2, '0');
                    element.style.transform = 'scale(1)';
                    element.style.color = 'var(--text-light)';
                }, 150);
            }
        }

        function startAutoRefresh() {
            let countdown = 10;
            const countdownElement = document.getElementById('countdown');

            if (!countdownElement) return;

            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;

                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    location.reload();
                }
            }, 1000);

            window.refreshInterval = countdownInterval;
        }

        function initFireworks() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const container = document.getElementById('fireworks');

                if (!container || !ctx) return;

                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                canvas.style.position = 'fixed';
                canvas.style.top = '0';
                canvas.style.left = '0';
                canvas.style.pointerEvents = 'none';
                canvas.style.zIndex = '0';
                container.appendChild(canvas);

                const fireworks = [];
                const particles = [];
                const colors = ['#FF5252', '#FF4500', '#C62828', '#E53935', '#FF8A80', '#FFD700'];

                class Firework {
                    constructor() {
                        this.x = Math.random() * canvas.width;
                        this.y = canvas.height;
                        this.targetX = (Math.random() - 0.5) * canvas.width * 0.5 + canvas.width / 2;
                        this.targetY = Math.random() * canvas.height * 0.3;
                        this.speed = 2 + Math.random() * 2;
                        this.size = 3;
                        this.color = colors[Math.floor(Math.random() * colors.length)];
                        this.exploded = false;
                    }

                    update() {
                        if (!this.exploded) {
                            const dx = this.targetX - this.x;
                            const dy = this.targetY - this.y;
                            const dist = Math.sqrt(dx * dx + dy * dy);

                            if (dist < this.speed) {
                                this.exploded = true;
                                this.explode();
                            } else {
                                this.x += dx / dist * this.speed;
                                this.y += dy / dist * this.speed;
                            }
                        }
                    }

                    explode() {
                        const particleCount = 60 + Math.random() * 40;
                        for (let i = 0; i < particleCount; i++) {
                            particles.push({
                                x: this.x,
                                y: this.y,
                                vx: (Math.random() - 0.5) * 8,
                                vy: (Math.random() - 0.5) * 8,
                                life: 60 + Math.random() * 40,
                                color: this.color,
                                size: 1 + Math.random() * 2
                            });
                        }
                    }

                    draw() {
                        if (!this.exploded) {
                            ctx.beginPath();
                            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                            ctx.fillStyle = this.color;
                            ctx.fill();
                        }
                    }
                }

                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    if (Math.random() < 0.05 && fireworks.length < 5) {
                        fireworks.push(new Firework());
                    }

                    for (let i = fireworks.length - 1; i >= 0; i--) {
                        fireworks[i].update();
                        fireworks[i].draw();

                        if (fireworks[i].exploded) {
                            fireworks.splice(i, 1);
                        }
                    }

                    for (let i = particles.length - 1; i >= 0; i--) {
                        particles[i].x += particles[i].vx;
                        particles[i].y += particles[i].vy;
                        particles[i].vy += 0.05;
                        particles[i].life--;

                        if (particles[i].life > 0) {
                            ctx.beginPath();
                            ctx.arc(particles[i].x, particles[i].y, particles[i].size, 0, Math.PI * 2);
                            ctx.fillStyle = particles[i].color;
                            ctx.globalAlpha = particles[i].life / 100;
                            ctx.fill();
                            ctx.globalAlpha = 1;
                        } else {
                            particles.splice(i, 1);
                        }
                    }

                    requestAnimationFrame(animate);
                }

                function resize() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }

                window.addEventListener('resize', resize);
                animate();

            } catch (error) {
                console.warn('烟花效果初始化失败:', error);
            }
        }

        if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
            document.onkeydown = function(e) {
                if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                    return false;
                }
            };

            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
        }

        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                console.log('页面被隐藏');
            } else {
                console.log('页面恢复显示');
            }
        });

        function cleanup() {
            if (window.refreshInterval) {
                clearInterval(window.refreshInterval);
            }
        }

        window.addEventListener('beforeunload', cleanup);
    </script>
</body>
</html>